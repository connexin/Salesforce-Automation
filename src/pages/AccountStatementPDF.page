<apex:page renderAs="pdf"
           showHeader="false"
           sidebar="false"
           docType="html-5.0"
           applyBodyTag="false"
           applyHtmlTag="false"
           Controller="AccountStatement"
>
    <html>
    <head>
        <style>
            @page {
                size: A4;
                margin-left: 30px;
                margin-right: 30px;
                margin-bottom: 105px;
                margin-top: 120px;
                @top-left-corner {
                    content: element(header);
                }
                @bottom-left-corner {
                    content: element(footer);
                }
            }
            div.header {
                position: running(header);
                margin-left: 40px;
                margin-top: 30px;
                width: 738px;
            }
            #recordType {
                float: right;
                font-size: 34px;
                vertical-align: bottom;
            }
            div.footer {
                position: running(footer);
                margin-bottom: 1mm;
                margin-left: 8mm;
            }
            #footercontent {
                margin-top: 25px;
                position: absolute;
                margin-left: 31px;
                float: left;
                z-index: -1;
                font-size: 13px;
                width: 100%;
            }
            
            .colouredText {
                color: {! textColour };
            }
            .bold {
                font-weight: bold;
            }
            body {
                font-family: Calibri;
            }
            .title {
                font-size: 20px;
                font-weight: bold;
                color: {! textColour };
            }
            
            #line {
                width: 100%;
                border: 1px solid {! textColour };
            }
            
            #addresses {
                margin-top: 10px;
            }
            #billingAddress {
                text-align: right;
                float: right;
                width: 250px;
            }
            #connexinAddress {
                float: left;
            }
            
            #info {
                margin-top: 150px;
            }
            #info table {
                width: 100%;
            }
            
            
            #statementLines {
                margin-top: 25px;
                page-break-inside: auto;
                width: 100%;
            }
            .statementLinesTable {
                width: 100%;
            }
            .statementLinesTable thead {
                background-color: {! textColour };
                color: white;
            }
            .statementLinesTable thead tr {
                height: 50px;
            }
            .statementLinesTable tbody tr {
                height: 40px;
            }
            .oddRow {
                background-color: {! oddRowColour };
            }
            .evenRow {
                background-color: {! evenRowColour };
            }
            
            #total {
                margin-top: 25px;
                float: right;
                text-align: right;
                margin-right: 3px;
            }
        </style>
    </head>
    <body>
        
        <div class="header">
            <apex:image url="{! logo }" height="40px" />
            <div id="recordType" class="colouredText" >Account Statement</div>
        </div>
        
        <div class="footer">
            <div id="footercontent">
                <span class="colouredText bold">Connexin:</span> 9th Floor, 107 Cheapside, London<br />EC2V 6DN<br />
                <br />
                <span class="colouredText bold">t:</span> 01482 363738 <span class="colouredText bold">w:</span> {! website } 
            </div>
            <apex:image url="{! footerImage }" width="205mm" />
        </div>
        
        <div>
            <div id="line" />
            <div id="addresses">
                <div id="connexinAddress">
                    <div class="title">Connexin Limited</div>
                    <div id="address">
                        9th Floor<br />
                        107 Cheapside<br />
                        London<br />
                        EC2V 6DN
                    </div>
                </div>
                
                <div id="billingAddress">
                    <span class="title"><apex:outputText value="{! account.Name }" /></span><br />
                    <apex:repeat value="{! addressComponents }" var="component" >
                        <apex:outputText value="{! component }" /><br />
                    </apex:repeat>
                </div>
            </div>
            
            <div id="info" >
                <table>
                    <tr>
                        <td>
                            <span class="colouredText bold">Account Number</span>
                        </td>
                        <td>
                            <apex:outputText value="{! accountId}" /> 
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <span class="colouredText bold">Statement Start Date</span>
                        </td>
                        <td>
                            <apex:outputText value="{0, date, MMMM d',' yyyy }" >
                                <apex:param value="{! startDate}" /> 
                            </apex:outputText>
                        </td>
                        <td>
                            <span class="colouredText bold">Statement End Date</span>
                        </td>
                        <td>
                            <apex:outputText value="{0, date, MMMM d',' yyyy }" >
                                <apex:param value="{! endDate}" /> 
                            </apex:outputText>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        
        <div id="statementlines" >
            
            <apex:dataTable value="{! sortedList }" var="line" styleClass="statementLinesTable" rowClasses="oddRow,evenRow" >
                
                <apex:column width="75px">
                    <apex:facet name="header">Date</apex:facet>
                    <!--apex:outputText value="{! line.sortDate }" /-->
                    <apex:outputText value="{0, date, MMMM d',' yyyy }" >
                    	<apex:param value="{! line.sortDate}" /> 
                    </apex:outputText>
                </apex:column>
                
                <apex:column width="45px">
                    <apex:facet name="header">Type</apex:facet>
                    <apex:outputText value="{! line.objectType}"/>
                </apex:column>
                
                <apex:column width="40px">
                    <apex:facet name="header">Reference</apex:facet>
                    <apex:outputText value="{! line.reference }" />
                </apex:column>
                
                <apex:column width="75px">
                    <apex:facet name="header">Status</apex:facet>
                    <apex:outputText value="{! line.status}"/>
                </apex:column>
                
                <apex:column width="65px">
                    <apex:facet name="header">Debit</apex:facet>
                    <apex:outputText value="£{0,Number,###,###,##0.00}" >
                        <apex:param value="{! line.debit_amount }" />
                    </apex:outputText>
                </apex:column>
                
                <apex:column width="65px">
                    <apex:facet name="header">Credit</apex:facet>
                    <apex:outputText value="£{0,Number,###,###,##0.00}" >
                        <apex:param value="{! line.credit_amount }" />
                    </apex:outputText>
                </apex:column>
                
                <apex:column width="65px">
                    <apex:facet name="header">
                        <apex:outputText value="Opening Balance £{0,Number,###,###,##0.00}" >
                            <apex:param value="{! initialbalance }" />
                        </apex:outputText>
                    </apex:facet>
                    <apex:outputText value="£{0,Number,###,###,##0.00}" >
                        <apex:param value="{! line.balance_amount }" />
                    </apex:outputText>
                </apex:column>
                
            </apex:dataTable>          
            
            <div id="total">
                <table>
                    <tr>
                        <td class="colouredText bold">Closing Debit&nbsp;&nbsp;&nbsp;</td>
                        <td>
                            <apex:outputText value="£{0,Number,###,###,##0.00}" >
                                <apex:param value="{! closingdebit }" />
                            </apex:outputText>
                        </td>
                        
                        <td class="colouredText bold">Closing Credit&nbsp;&nbsp;&nbsp;</td>
                        <td>
                            <apex:outputText value="£{0,Number,###,###,##0.00}" >
                                <apex:param value="{! closingcredit }" />
                            </apex:outputText>
                        </td>
                        
                        <td class="colouredText bold">Closing Balance&nbsp;&nbsp;&nbsp;</td>
                        <td>
                            <apex:outputText value="£{0,Number,###,###,##0.00}" >
                                <apex:param value="{! lastbalance }" />
                            </apex:outputText>
                        </td>
                    </tr>
                </table>
            </div>
            
        </div>
        
    </body>
   </html>
</apex:page>